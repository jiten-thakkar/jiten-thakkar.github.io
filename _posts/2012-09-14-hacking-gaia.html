---
layout: post
title: Hacking Gaia
date: '2012-09-13T17:07:00.000-07:00'
author: Jiten Thakkar
tags:
- Firefox OS
- Gaia
- b2g
modified_time: '2012-09-30T14:34:47.594-07:00'
thumbnail: http://4.bp.blogspot.com/-9HfP5sUPR4Y/UFJvZu1_1nI/AAAAAAAAAKs/caeWBULHXR8/s72-c/pic1.png
blogger_id: tag:blogger.com,1999:blog-4257776574536372826.post-8040309926767765656
blogger_orig_url: http://netij.blogspot.com/2012/09/hacking-gaia.html
comments: True
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on">Mozilla's Firefox OS also known as b2g is an&nbsp;awesome&nbsp;feat from the community towards its goal to provide platform for innovation and creativity. It was a necessary step considering the growth of mobile market. Smart phone is a front which lacks an open and powerful OS, which let's you hack into every aspect of the user experience(There is Android but it's not that easy to customize it.). In b2g, just by changing a CSS file or by modifying a JavaScript file, you can change the look and functionality of your phone dramatically.<br /><br />B2g uses <a href="http://hacks.mozilla.org/2012/02/gaia-mozillas-user-interface-for-boot-to-gecko-all-web-technologies/" target="_blank">Gaia</a> for it's UI. Gaia is all Html5,CSS and JavaScript. It can even run on a desktop browser(except the ). The whole OS is far from first release but you can start creating apps for it right now and try them on emulator, your desktop browser(for development purpose) or on your phone.<br /><br />There are two steps for building &nbsp;b2g and start working on an app. I have tried these steps on Linux and works for an emulator.<br /><br /><b>Building B2G:</b><br /><b><br /></b>If you don't want the pain of sitting around your laptop for hours, waiting for the compilation to finish, you can directly download latest version of b2g from <a href="http://ftp.mozilla.org/pub/mozilla.org/b2g/nightly/latest-mozilla-central/" target="_blank">here</a>.<br />If you still want to compile it by yourself then go ahead else skip to next part.<br /><br />Getting the source code from mozilla-central:<br /><br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> hg clone http://hg.mozilla.org/mozilla-central src  <br /> If you encounter an 'Command not found hg' you need to install Mercurial: https://developer.mozilla.org/en/Installing_Mercurial  </code></pre><br />Update the code:<br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> cd src  <br /> hg pull &amp;&amp; hg update  <br /></code></pre><br />Create a '.mozconfig' file in mozilla-central source directory and paste following in the file. Also read comments and act accordingly.<br /><br /></div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">  mk_add_options MOZ_OBJDIR=../build   <br />  #Here put NUMBER_OF_CORES_IN_YOUR_PROCESSOR+1 in place of '9'  <br />  mk_add_options MOZ_MAKE_FLAGS="-j9 -s"  <br />  ac_add_options --enable-application=b2g   <br />  ac_add_options --disable-libjpeg-turbo   <br />  # This option is required if you want to be able to run Gaia's tests   <br />  ac_add_options --enable-tests   <br />  # turn on mozTelephony/mozSms interfaces   <br />  # Only turn this line on if you actually have a dev phone   <br />  # you want to forward to. If you get crashes at startup,   <br />  # make sure this line is commented.   <br />  #ac_add_options --enable-b2g-ril</code></pre><br />Now, build:<br /><br /></div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> make -f client.mk build  <br /></code></pre>If you face any errors or difficulty in this step, refer <a href="https://developer.mozilla.org/en-US/docs/Simple_Firefox_build" target="_blank">this</a>&nbsp;for required library installation and other difficulties, but <b>DO NOT </b>change the '.mozconfig' file.<br /><br />Now you can go and have some coffee or even a nap because this is going to take long.<br /><br /><b>Building Gaia Profile:</b><br /><b><br /></b>First, clone repository from Github and update it:<br /><br /></div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> git clone https://github.com/mozilla-b2g/gaia gaia  <br /> cd gaia  <br /> git fetch  <br /> git merge origin/master  <br /></code></pre><br />Compile it:<br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> make  <br /></code></pre><br />Now, if you have downloaded nightly build of b2g then run:<br /><br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> /path/to/b2g -profile profile  <br /></code></pre>else:<br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> ../build/dist/bin/b2g -profile profile  <br /></code></pre><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-9HfP5sUPR4Y/UFJvZu1_1nI/AAAAAAAAAKs/caeWBULHXR8/s1600/pic1.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="200" src="http://4.bp.blogspot.com/-9HfP5sUPR4Y/UFJvZu1_1nI/AAAAAAAAAKs/caeWBULHXR8/s200/pic1.png" width="133" /></a></div>&nbsp;<a href="http://3.bp.blogspot.com/-rHrb_NXmX1M/UFJva1OGFOI/AAAAAAAAAKw/9QkNP6o8VfA/s1600/pic2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="200" src="http://3.bp.blogspot.com/-rHrb_NXmX1M/UFJva1OGFOI/AAAAAAAAAKw/9QkNP6o8VfA/s200/pic2.png" width="133" /></a><a href="http://1.bp.blogspot.com/-U2Dojz8NtY8/UFJvcHBMY-I/AAAAAAAAAK4/MPpwZyiJoM8/s1600/pic3.png" imageanchor="1" style="clear: left; display: inline !important; margin-bottom: 1em; margin-right: 1em; text-align: center;"><img border="0" height="200" src="http://1.bp.blogspot.com/-U2Dojz8NtY8/UFJvcHBMY-I/AAAAAAAAAK4/MPpwZyiJoM8/s200/pic3.png" width="132" /></a><a href="http://1.bp.blogspot.com/-AYN8MG8kdnk/UFJvdGFTLkI/AAAAAAAAALA/Z-9xHc3Jyuk/s1600/pic4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="200" src="http://1.bp.blogspot.com/-AYN8MG8kdnk/UFJvdGFTLkI/AAAAAAAAALA/Z-9xHc3Jyuk/s200/pic4.png" width="132" /></a><br /><br /><br />All the apps are in /gaia/apps directory.<br /><br /><b>Steps to add a new app:</b><br /><br />To create and test a new app on the emulator, create a new directory under apps directory.<br />Add your Html,CSS and JavaScript code in the directory and create a 'manifest.webapp' file with necessary information about the app. You can checkout &nbsp;pre-installed apps manifest files for&nbsp;reference.<br />After doing that, append your app details in the file gaia/webapps.js. Like if your app name is 'HelloWorld', then you will make a directory named 'helloworld' in gaia/apps directory and put all you app code there.<br />Now create a 'manifest.webapp' file in 'helloworld' directory and fill in necessary details like app name, developer name, orientation, language localisation etc.<br />Now append following in webapps.js file where all the apps are added to a js object:<br /><br /></div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> "helloworld": {  <br />   "origin": rootPath.replace('%%%', 'helloworld'),  <br />   "installOrigin": "http://helloworld.localhost.org:8080",  <br />   "receipt": null,  <br />   "installTime": 132333986000,  <br />   "manifestURL": "http://helloworld.localhost.org:8080/manifest.webapp"  <br />  }  <br /></code></pre><br />Now run following in gaia directory:<br /><br /></div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> make install-gaia<br />/path/to/b2g -profile profile<br /></code></pre><br />Now you can run your app in emulator and check it out.<br />You can find more details about running Gaia on phone or on a browser <a href="https://wiki.mozilla.org/Gaia/Hacking" target="_blank">here</a>.</div>
